(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["editar-ingresos"],{1779:function(t,e,o){"use strict";o("2639")},"1dde":function(t,e,o){var a=o("d039"),r=o("b622"),i=o("2d00"),s=r("species");t.exports=function(t){return i>=51||!a((function(){var e=[],o=e.constructor={};return o[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},2639:function(t,e,o){},"4b62":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"agregarProv"},[o("div",{staticClass:"formAgregar",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardar()}}},[o("h3",{staticClass:"title"},[t._v("Agregar o editar Ingreso")]),o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"proveedor"}},[t._v("Proveedor")]),o("br"),this.editar?t._e():o("select",{directives:[{name:"model",rawName:"v-model",value:t.proveedor,expression:"proveedor"}],staticClass:"input cat",attrs:{name:"proveedor"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.proveedor=e.target.multiple?o:o[0]}}},[o("option",{staticClass:"opcion",attrs:{value:"Seleccione un proveedor",selected:""}},[t._v("Seleccione una proveedor")]),o("hr"),t._l(t.proveedores,(function(e){return o("option",{key:e._id,staticClass:"opcion",domProps:{value:e._id}},[t._v(t._s(e.nombre))])}))],2),this.editar?o("div",{staticClass:"modificar"},[o("input",{staticClass:"input",attrs:{type:"text"},domProps:{value:t.proveedor.nombre}}),o("p",{staticClass:"modText",on:{click:function(e){return t.modificarProv()}}},[t._v("Modificar proveedor")])]):t._e(),this.modificar.prov&&this.editar?o("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?o:o[0]}}},[o("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione proveedor")]),o("hr"),t._l(t.proveedores,(function(e){return o("option",{key:e._id,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e.nombre))])}))],2):t._e()]),o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"categoria"}},[t._v("Tipo Comprobante")]),o("br"),this.editar?t._e():o("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?o:o[0]}}},[o("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione comprobante")]),o("hr"),t._l(t.tiposComprobante,(function(e){return o("option",{key:e,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e))])}))],2),this.editar?o("div",{staticClass:"modificar"},[o("input",{staticClass:"input",attrs:{type:"text"},domProps:{value:this.tipoComprobante}}),o("p",{staticClass:"modText",on:{click:function(e){return t.modificarTComp()}}},[t._v(" Modificar tipo comprobante ")])]):t._e(),this.modificar.tComp&&this.editar?o("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?o:o[0]}}},[o("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione comprobante")]),o("hr"),t._l(t.tiposComprobante,(function(e){return o("option",{key:e,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e))])}))],2):t._e()]),o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"serieComprobante"}},[t._v("Serie Comprobante")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.serieComprobante,expression:"serieComprobante",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"serieComprobante",placeholder:"Serie de comprobante...",type:"number"},domProps:{value:t.serieComprobante},on:{input:function(e){e.target.composing||(t.serieComprobante=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"numComprobante"}},[t._v("Número Comprobante")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.numComprobante,expression:"numComprobante",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"numComprobante",placeholder:"Numero de comprobante...",type:"number"},domProps:{value:t.numComprobante},on:{input:function(e){e.target.composing||(t.numComprobante=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"impuesto"}},[t._v("Impuesto")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.impuesto,expression:"impuesto",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"impuesto",placeholder:"Impuesto...",type:"number"},domProps:{value:t.impuesto},on:{input:function(e){e.target.composing||(t.impuesto=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"precio"}},[t._v("Precio")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.precio,expression:"precio",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"precio",type:"number",placeholder:"Precio articulo"},domProps:{value:t.precio},on:{input:function(e){e.target.composing||(t.precio=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"cantidad"}},[t._v("Cantidad")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cantidad,expression:"cantidad",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"cantidad",type:"number",placeholder:"Cantidad"},domProps:{value:t.cantidad},on:{input:function(e){e.target.composing||(t.cantidad=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),o("div",{staticClass:"duo"},[o("label",{staticClass:"label",attrs:{for:"codigo"}},[t._v("Articulo")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model",value:t.codigo,expression:"codigo"}],staticClass:"input",attrs:{name:"codigo",type:"text",placeholder:"Codigo de articulo"},domProps:{value:t.codigo},on:{input:function(e){e.target.composing||(t.codigo=e.target.value)}}})]),o("div",{staticClass:"duo"},[o("label",{attrs:{for:""}}),o("br"),o("button",{staticClass:"guardar",on:{click:function(e){return t.agregarArticulo()}}},[t._v(" Agregar lote de articulos ")])])]),t.articulos.length?o("div",{staticClass:"moduloArt"},[o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo"},[o("h4",{staticClass:"tituloAgregados"},[t._v("Monto total: "+t._s(t.total))]),o("h4",{staticClass:"tituloAgregados"},[t._v(" Lote de articulos agregados: "+t._s(t.articulos.length)+" ")])])]),t._m(0),o("div",{staticClass:"grupo articulosAgregados"},t._l(t.articulos,(function(e,a){return o("div",{key:e._id,staticClass:"duo articuloDuo"},[o("i",{staticClass:"equis fas fa-times",on:{click:function(e){return t.eliminarArt(a)}}}),o("label",{staticClass:"labelArticulo"},[o("b",[t._v(t._s(e.articulo))])]),o("p",{staticClass:"detalleArticulo"},[o("b",[t._v("Precio: ")]),o("span",{staticClass:"render"},[t._v("  "+t._s(e.precio))])]),o("p",{staticClass:"detalleArticulo"},[o("b",[t._v("Cantidad: ")]),o("span",{staticClass:"render"},[t._v("  "+t._s(e.cantidad))])]),o("p",{staticClass:"detalleArticulo"},[o("b",[t._v("Precio total: ")]),o("span",{staticClass:"render"},[t._v("  "+t._s(e.subtotal))])]),o("p",{staticClass:"detalleArticulo"},[o("b",[t._v("Id: ")]),o("span",{staticClass:"render"},[t._v("  "+t._s(e._id))])])])})),0)]):t._e(),o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo botones"},[o("button",{staticClass:"guardar",on:{click:function(e){return t.guardar()}}},[t._v(" Guardar ingreso ")]),o("router-link",{staticClass:"guardar volver",attrs:{to:"/compras/ingresos"}},[t._v(" Volver sin guardar ")])],1)]),t._l(t.validarMensaje,(function(e){return o("div",{key:e,staticClass:"divErrores"},[o("p",{staticClass:"errores"},[t._v("* "+t._s(e))])])})),o("br")],2)])},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"grupo"},[o("div",{staticClass:"duo"},[o("h3",{staticClass:"tituloAgregados"},[t._v("Articulos agregados")])])])}],i=(o("a434"),o("bc3a")),s=o.n(i),n={data:function(){return{usuario:this.$store.state.usuario,proveedor:"",tipoComprobante:"",tiposComprobante:["Factura","Boleta","Factura Electronica","Boleta Electronica"],serieComprobante:"",numComprobante:"",impuesto:"",codigo:"",ingreso:{},total:0,precio:"",cantidad:"",subTotal:0,ruta:this.$router.currentRoute.fullPath,editar:!1,validar:0,validarMensaje:[],usuarios:[],proveedores:[],articulos:[],modificar:{tComp:!1,prov:!1,usuario:!1}}},methods:{guardar:function(){if(this.validacion(),this.validar<=0)if(this.editar){var t={Token:this.$store.state.token},e={headers:t};s.a.put("ingreso/update",{usuario:this.usuario,persona:this.proveedor,tipo_comprobante:this.tipoComprobante,serie_comprobante:this.serieComprobante,num_comprobante:this.numComprobante,impuesto:this.impuesto,total:this.total,detalles:this.articulos},e).then((function(t){console.log("Ingreso actualizado exitosamente: "+t.data.nombre)})).catch((function(t){console.log(t),alert("No se pudo actualizar el ingreso")})),this.limpiar(),this.$router.push({path:"/compras/ingresos"})}else{var o={Token:this.$store.state.token},a={headers:o};s.a.post("ingreso/add",{usuario:this.usuario,persona:this.proveedor,tipo_comprobante:this.tipoComprobante,serie_comprobante:this.serieComprobante,num_comprobante:this.numComprobante,impuesto:this.impuesto,total:this.total,detalles:this.articulos},a).then((function(t){console.log("Ingreso agregado exitosamente: "+t.data.nombre)})).catch((function(t){console.log(t),alert("no se pudo agregar el ingreso")})),this.limpiar(),this.$router.push({path:"/compras/ingresos"})}else console.log("Error en la validacion")},opcion:function(){"/compras/ingresos/add"==this.ruta||"/"==this.ruta?this.editar=!1:(this.buscarPorId(),this.editar=!0)},buscarPorId:function(){var t=this,e={Token:this.$store.state.token},o={headers:e};s.a.get("ingreso/query?_id="+this.$router.currentRoute.params.id,o).then((function(e){t.usuario=e.data.usuario,t.proveedor=e.data.persona,t.tipoComprobante=e.data.tipo_comprobante,t.serieComprobante=e.data.serie_comprobante,t.numComprobante=e.data.num_comprobante,t.impuesto=e.data.impuesto,t.total=e.data.total,t.articulos=e.data.detalles})).catch((function(t){console.log("error del query: "+t)}))},validacion:function(){return this.validar=0,this.validarMensaje=[],(this.serieComprobante.length<1||this.serieComprobante.length>7)&&this.validarMensaje.push("Debe ingresar el numero de serie del comprobante y este no puede ser mayor a 7"),(this.numComprobante.length<1||this.numComprobante.length>10)&&this.validarMensaje.push("Debe ingresar el numero del comprobante y este no puede ser mayor a 10"),(this.impuesto.length<1||this.impuesto.length>10)&&this.validarMensaje.push("Debe ingresar el impuesto y este no puede ser mayor a 10 caracteres"),this.validarMensaje.length&&(this.validar=1),this.validar},listarUsuarios:function(){var t=this,e={Token:this.$store.state.token},o={headers:e};s.a.get("usuario/list",o).then((function(e){t.usuarios=e.data})).catch((function(t){console.log(t)}))},listarProveedores:function(){var t=this,e={Token:this.$store.state.token},o={headers:e};s.a.get("persona/list-proveedores",o).then((function(e){t.proveedores=e.data})).catch((function(t){console.log(t)}))},agregarArticulo:function(){var t=this,e={Token:this.$store.state.token},o={headers:e};s.a.get("articulo/query-codigo?codigo="+this.codigo,o).then((function(e){t.precio=t.precio*t.cantidad,t.articulos.push({_id:e.data._id,articulo:e.data.nombre,cantidad:t.cantidad,subTotal:t.subTotal,precio:e.data.precio_venta}),t.indice++,t.total=t.total+t.subTotal})).catch((function(t){console.log(t)}))},cargarPrecioArticulo:function(){var t=this;this.cantidad="";var e={Token:this.$store.state.token},o={headers:e};s.a.get("articulo/query-codigo?codigo="+this.codigo,o).then((function(e){t.precio=e.data.precio_venta,console.log(t.precio)}))},calcularSubtotal:function(){this.subTotal=this.cantidad*this.precio},limpiar:function(){this.precio="",this.cantidad="",this.codigo="",this.subTotal=""},eliminarArt:function(t){var e=this.articulos[t].subTotal;this.total=this.total-e,this.articulos.splice(t,1)},modificarTComp:function(){this.modificar.tComp?this.modificar.tComp=!1:this.modificar.tComp=!0},modificarProv:function(){this.modificar.prov?this.modificar.prov=!1:this.modificar.prov=!0},modificarUsuario:function(){this.modificar.usuario?this.modificar.usuario=!1:this.modificar.usuario=!0}},created:function(){this.opcion(),this.listarUsuarios(),this.listarProveedores()}},c=n,l=(o("1779"),o("2877")),u=Object(l["a"])(c,a,r,!1,null,"da4ddd0a",null);e["default"]=u.exports},"65f0":function(t,e,o){var a=o("861d"),r=o("e8b5"),i=o("b622"),s=i("species");t.exports=function(t,e){var o;return r(t)&&(o=t.constructor,"function"!=typeof o||o!==Array&&!r(o.prototype)?a(o)&&(o=o[s],null===o&&(o=void 0)):o=void 0),new(void 0===o?Array:o)(0===e?0:e)}},8418:function(t,e,o){"use strict";var a=o("c04e"),r=o("9bf2"),i=o("5c6c");t.exports=function(t,e,o){var s=a(e);s in t?r.f(t,s,i(0,o)):t[s]=o}},a434:function(t,e,o){"use strict";var a=o("23e7"),r=o("23cb"),i=o("a691"),s=o("50c4"),n=o("7b0b"),c=o("65f0"),l=o("8418"),u=o("1dde"),d=u("splice"),p=Math.max,m=Math.min,v=9007199254740991,h="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var o,a,u,d,f,b,g=n(this),C=s(g.length),_=r(t,C),y=arguments.length;if(0===y?o=a=0:1===y?(o=0,a=C-_):(o=y-2,a=m(p(i(e),0),C-_)),C+o-a>v)throw TypeError(h);for(u=c(g,a),d=0;d<a;d++)f=_+d,f in g&&l(u,d,g[f]);if(u.length=a,o<a){for(d=_;d<C-a;d++)f=d+a,b=d+o,f in g?g[b]=g[f]:delete g[b];for(d=C;d>C-a+o;d--)delete g[d-1]}else if(o>a)for(d=C-a;d>_;d--)f=d+a-1,b=d+o-1,f in g?g[b]=g[f]:delete g[b];for(d=0;d<o;d++)g[d+_]=arguments[d+2];return g.length=C-a+o,u}})},e8b5:function(t,e,o){var a=o("c6b6");t.exports=Array.isArray||function(t){return"Array"==a(t)}}}]);
//# sourceMappingURL=editar-ingresos.ebea5dfc.js.map