(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["editar-ventas"],{"0b42":function(t,e,a){"use strict";a("840d")},"1dde":function(t,e,a){var o=a("d039"),i=a("b622"),r=a("2d00"),s=i("species");t.exports=function(t){return r>=51||!o((function(){var e=[],a=e.constructor={};return a[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"65f0":function(t,e,a){var o=a("861d"),i=a("e8b5"),r=a("b622"),s=r("species");t.exports=function(t,e){var a;return i(t)&&(a=t.constructor,"function"!=typeof a||a!==Array&&!i(a.prototype)?o(a)&&(a=a[s],null===a&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===e?0:e)}},"840d":function(t,e,a){},8418:function(t,e,a){"use strict";var o=a("c04e"),i=a("9bf2"),r=a("5c6c");t.exports=function(t,e,a){var s=o(e);s in t?i.f(t,s,r(0,a)):t[s]=a}},a434:function(t,e,a){"use strict";var o=a("23e7"),i=a("23cb"),r=a("a691"),s=a("50c4"),n=a("7b0b"),c=a("65f0"),l=a("8418"),u=a("1dde"),d=u("splice"),p=Math.max,m=Math.min,v=9007199254740991,h="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var a,o,u,d,b,f,C=n(this),g=s(C.length),_=i(t,g),y=arguments.length;if(0===y?a=o=0:1===y?(a=0,o=g-_):(a=y-2,o=m(p(r(e),0),g-_)),g+a-o>v)throw TypeError(h);for(u=c(C,o),d=0;d<o;d++)b=_+d,b in C&&l(u,d,C[b]);if(u.length=o,a<o){for(d=_;d<g-o;d++)b=d+o,f=d+a,b in C?C[f]=C[b]:delete C[f];for(d=g;d>g-o+a;d--)delete C[d-1]}else if(a>o)for(d=g-o;d>_;d--)b=d+o-1,f=d+a-1,b in C?C[f]=C[b]:delete C[f];for(d=0;d<a;d++)C[d+_]=arguments[d+2];return C.length=g-o+a,u}})},b5ac:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"agregarProv"},[a("div",{staticClass:"formAgregar",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardar()}}},[a("h3",{staticClass:"title"},[t._v("Agregar o editar Venta")]),a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"cliente"}},[t._v("Cliente")]),a("br"),this.editar?t._e():a("select",{directives:[{name:"model",rawName:"v-model",value:t.cliente,expression:"cliente"}],staticClass:"input cat",attrs:{name:"cliente"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cliente=e.target.multiple?a:a[0]}}},[a("option",{staticClass:"opcion",attrs:{value:"Seleccione un cliente",selected:""}},[t._v("Seleccione una cliente")]),a("hr"),t._l(t.clientes,(function(e){return a("option",{key:e._id,staticClass:"opcion",domProps:{value:e._id}},[t._v(t._s(e.nombre))])}))],2),this.editar?a("div",{staticClass:"modificar"},[a("input",{staticClass:"input",attrs:{type:"text"},domProps:{value:t.cliente.nombre}}),a("p",{staticClass:"modText",on:{click:function(e){return t.modificarProv()}}},[t._v("Modificar cliente")])]):t._e(),this.modificar.prov&&this.editar?a("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?a:a[0]}}},[a("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione cliente")]),a("hr"),t._l(t.clientes,(function(e){return a("option",{key:e._id,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e.nombre))])}))],2):t._e()]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"categoria"}},[t._v("Tipo Comprobante")]),a("br"),this.editar?t._e():a("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?a:a[0]}}},[a("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione comprobante")]),a("hr"),t._l(t.tiposComprobante,(function(e){return a("option",{key:e,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e))])}))],2),this.editar?a("div",{staticClass:"modificar"},[a("input",{staticClass:"input",attrs:{type:"text"},domProps:{value:this.tipoComprobante}}),a("p",{staticClass:"modText",on:{click:function(e){return t.modificarTComp()}}},[t._v(" Modificar tipo comprobante ")])]):t._e(),this.modificar.tComp&&this.editar?a("select",{directives:[{name:"model",rawName:"v-model",value:t.tipoComprobante,expression:"tipoComprobante"}],staticClass:"input cat",attrs:{name:"usuarios"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.tipoComprobante=e.target.multiple?a:a[0]}}},[a("option",{staticClass:"opcion",attrs:{value:"Seleccione una categoria",selected:""}},[t._v("Seleccione comprobante")]),a("hr"),t._l(t.tiposComprobante,(function(e){return a("option",{key:e,staticClass:"opcion",domProps:{value:e}},[t._v(t._s(e))])}))],2):t._e()]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"serieComprobante"}},[t._v("Serie Comprobante")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.serieComprobante,expression:"serieComprobante",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"serieComprobante",placeholder:"Serie de comprobante...",type:"number"},domProps:{value:t.serieComprobante},on:{input:function(e){e.target.composing||(t.serieComprobante=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"numComprobante"}},[t._v("Número Comprobante")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.numComprobante,expression:"numComprobante",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"numComprobante",placeholder:"Numero de comprobante...",type:"number"},domProps:{value:t.numComprobante},on:{input:function(e){e.target.composing||(t.numComprobante=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"impuesto"}},[t._v("Impuesto")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.impuesto,expression:"impuesto",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"impuesto",placeholder:"Impuesto...",type:"number"},domProps:{value:t.impuesto},on:{input:function(e){e.target.composing||(t.impuesto=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"precio"}},[t._v("Precio")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.precio,expression:"precio",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"precio",type:"number",placeholder:"Precio articulo"},domProps:{value:t.precio},on:{input:function(e){e.target.composing||(t.precio=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"cantidad"}},[t._v("Cantidad")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cantidad,expression:"cantidad",modifiers:{number:!0}}],staticClass:"input",attrs:{name:"cantidad",type:"number",placeholder:"Cantidad"},domProps:{value:t.cantidad},on:{input:[function(e){e.target.composing||(t.cantidad=t._n(e.target.value))},function(e){return t.calcularSubtotal()}],blur:function(e){return t.$forceUpdate()}}})]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"codigo"}},[t._v("Articulo")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.codigo,expression:"codigo"}],staticClass:"input",attrs:{name:"codigo",type:"text",placeholder:"Codigo de articulo"},domProps:{value:t.codigo},on:{input:[function(e){e.target.composing||(t.codigo=e.target.value)},function(e){return t.cargarPrecioArticulo()}]}})]),a("div",{staticClass:"duo"},[a("label",{staticClass:"label",attrs:{for:"descuento"}},[t._v("Descuento")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.descuento,expression:"descuento"}],staticClass:"input",attrs:{name:"descuento",type:"text",placeholder:"Descuento del articulo"},domProps:{value:t.descuento},on:{input:function(e){e.target.composing||(t.descuento=e.target.value)}}})]),a("div",{staticClass:"duo"},[a("label",{attrs:{for:""}}),a("br"),a("button",{staticClass:"guardar",on:{click:function(e){return t.agregarArticulo()}}},[t._v(" Agregar lote de articulos ")])])]),t.articulos.length?a("div",{staticClass:"moduloArt"},[a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo"},[a("h4",{staticClass:"tituloAgregados"},[t._v("Monto total: "+t._s(t.total))]),a("h4",{staticClass:"tituloAgregados"},[t._v(" Lotes de articulos agregados: "+t._s(t.articulos.length)+" ")])])]),t._m(0),a("div",{staticClass:"grupo articulosAgregados"},t._l(t.articulos,(function(e,o){return a("div",{key:e._id,staticClass:"duo articuloDuo"},[a("i",{staticClass:"equis fas fa-times",on:{click:function(e){return t.eliminarArt(o)}}}),a("label",{staticClass:"labelArticulo"},[a("b",[t._v(t._s(e.articulo))])]),a("p",{staticClass:"detalleArticulo"},[a("b",[t._v("Precio por unidad: ")]),a("span",{staticClass:"render"},[t._v("  "+t._s(e.precio))])]),a("p",{staticClass:"detalleArticulo"},[a("b",[t._v("Cantidad: ")]),a("span",{staticClass:"render"},[t._v("  "+t._s(e.cantidad))])]),a("p",{staticClass:"detalleArticulo"},[a("b",[t._v("Precio total: ")]),a("span",{staticClass:"render"},[t._v("  "+t._s(e.subTotal))])]),a("p",{staticClass:"detalleArticulo"},[a("b",[t._v("Id: ")]),a("span",{staticClass:"render"},[t._v("  "+t._s(e._id))])])])})),0)]):t._e(),a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo botones"},[a("button",{staticClass:"guardar",on:{click:function(e){return t.guardar()}}},[t._v(" Guardar venta ")]),a("router-link",{staticClass:"guardar volver",attrs:{to:"/ventas"}},[t._v(" Volver sin guardar ")])],1)]),t._l(t.validarMensaje,(function(e){return a("div",{key:e,staticClass:"divErrores"},[a("p",{staticClass:"errores"},[t._v("* "+t._s(e))])])})),a("br")],2)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"grupo"},[a("div",{staticClass:"duo"},[a("h3",{staticClass:"tituloAgregados"},[t._v("Articulos agregados")])])])}],r=(a("a434"),a("bc3a")),s=a.n(r),n={data:function(){return{usuario:this.$store.state.usuario,cliente:"",tipoComprobante:"",tiposComprobante:["Factura","Boleta","Factura Electronica","Boleta Electronica"],serieComprobante:"",numComprobante:"",impuesto:"",descuento:"",codigo:"",venta:{},total:0,precio:"",cantidad:"",subTotal:0,ruta:this.$router.currentRoute.fullPath,editar:!1,validar:0,validarMensaje:[],usuarios:[],clientes:[],articulos:[],modificar:{tComp:!1,prov:!1,usuario:!1}}},methods:{guardar:function(){if(this.validacion(),this.validar<=0)if(this.editar){var t={Token:this.$store.state.token},e={headers:t};s.a.put("venta/update",{usuario:this.usuario,persona:this.cliente,tipo_comprobante:this.tipoComprobante,serie_comprobante:this.serieComprobante,num_comprobante:this.numComprobante,impuesto:this.impuesto,total:this.total,detalles:this.articulos},e).then((function(t){console.log("Venta actualizada exitosamente: "+t.data.nombre)})).catch((function(t){console.log(t),alert("No se pudo actualizar el ingreso")})),this.limpiar(),this.$router.push({path:"/ventas"})}else{var a={Token:this.$store.state.token},o={headers:a};s.a.post("venta/add",{usuario:this.usuario,persona:this.cliente,tipo_comprobante:this.tipoComprobante,serie_comprobante:this.serieComprobante,num_comprobante:this.numComprobante,impuesto:this.impuesto,total:this.total,detalles:this.articulos},o).then((function(t){console.log("Venta agregada exitosamente: "+t.data.nombre)})).catch((function(t){console.log(t),alert("no se pudo agregar el ingreso")})),this.limpiar(),this.$router.push({path:"/ventas"})}else console.log("Error en la validacion")},opcion:function(){"/ventas/add"==this.ruta||"/"==this.ruta?this.editar=!1:(this.buscarPorId(),this.editar=!0)},buscarPorId:function(){var t=this,e={Token:this.$store.state.token},a={headers:e};s.a.get("venta/query?_id="+this.$router.currentRoute.params.id,a).then((function(e){t.usuario=e.data.usuario,t.cliente=e.data.persona,t.tipoComprobante=e.data.tipo_comprobante,t.serieComprobante=e.data.serie_comprobante,t.numComprobante=e.data.num_comprobante,t.impuesto=e.data.impuesto,t.total=e.data.total,t.articulos=e.data.detalles})).catch((function(t){console.log("error del query: "+t)}))},validacion:function(){return this.validar=0,this.validarMensaje=[],(this.serieComprobante.length<1||this.serieComprobante.length>7)&&this.validarMensaje.push("Debe ingresar el numero de serie del comprobante y este no puede ser mayor a 7"),(this.numComprobante.length<1||this.numComprobante.length>10)&&this.validarMensaje.push("Debe ingresar el numero del comprobante y este no puede ser mayor a 10"),(this.impuesto.length<1||this.impuesto.length>10)&&this.validarMensaje.push("Debe ingresar el impuesto y este no puede ser mayor a 10 caracteres"),this.validarMensaje.length&&(this.validar=1),this.validar},listarUsuarios:function(){var t=this,e={Token:this.$store.state.token},a={headers:e};s.a.get("usuario/list",a).then((function(e){t.usuarios=e.data})).catch((function(t){console.log(t)}))},listarClientes:function(){var t=this,e={Token:this.$store.state.token},a={headers:e};s.a.get("persona/list-clientes",a).then((function(e){t.clientes=e.data})).catch((function(t){console.log(t)}))},agregarArticulo:function(){var t=this,e={Token:this.$store.state.token},a={headers:e};s.a.get("articulo/query-codigo?codigo="+this.codigo,a).then((function(e){t.articulos.push({_id:e.data._id,articulo:e.data.nombre,cantidad:t.cantidad,precio:e.data.precio_venta,subTotal:t.subTotal,descuento:t.descuento}),t.indice++,t.total=t.total+t.subTotal})).catch((function(t){console.log(t)}))},cargarPrecioArticulo:function(){var t=this;this.cantidad="";var e={Token:this.$store.state.token},a={headers:e};s.a.get("articulo/query-codigo?codigo="+this.codigo,a).then((function(e){t.precio=e.data.precio_venta,console.log(t.precio)}))},calcularSubtotal:function(){this.subTotal=this.cantidad*this.precio},limpiar:function(){this.precio=0,this.cantidad=0,this.codigo=0,this.subTotal=0},eliminarArt:function(t){var e=this.articulos[t].subTotal;this.total=this.total-e,this.articulos.splice(t,1)},modificarTComp:function(){this.modificar.tComp?this.modificar.tComp=!1:this.modificar.tComp=!0},modificarProv:function(){this.modificar.prov?this.modificar.prov=!1:this.modificar.prov=!0},modificarUsuario:function(){this.modificar.usuario?this.modificar.usuario=!1:this.modificar.usuario=!0}},created:function(){this.opcion(),this.listarUsuarios(),this.listarClientes()}},c=n,l=(a("0b42"),a("2877")),u=Object(l["a"])(c,o,i,!1,null,"bae82478",null);e["default"]=u.exports},e8b5:function(t,e,a){var o=a("c6b6");t.exports=Array.isArray||function(t){return"Array"==o(t)}}}]);
//# sourceMappingURL=editar-ventas.3947b655.js.map